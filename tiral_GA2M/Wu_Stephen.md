# Bayesの研究
## 何故Bayes？
- 不安定性(不確実性)の定量化
  - 工学出身の身なのでここを意識する

## ベイズって何？？

- $P(A|B) = \frac{P(B|A)P(A)}{P(B)}$
  - 数式にあるA,Bに意味はないが、そこに意味を与えるといろいろの応用ができます。
  - 工学的にいうと、順問題を利用して逆問題を解く(入力←→出力)

- D(data), y(object), M(Model), $\theta$(variables)
  - Robust posterior prediction
    - $$p(y|D) = \sum_{i=1}^n{p(y|M_i,D)p(M_i|D)}$$
  - Bayesian model selection
  - 
## 緊急地震速報
- 難しい。でもだからこそ不安定性の定量化が大きい意味を持つ。

### 背景
- 「地震の揺れを予測したい」
  - 揺れを目的変数
    - マグニチュード
    - 深さ
    - 震央からの距離
    - 初期時間と将来時間
### 緊急地震速報のロジック
- データから揺れの大きさの程度を予測する
  - P波(速い波)からどの程度の精度でS波(遅い波)の大きさを予測できるか？
  - 計算が速くないといけない(S波に勝たないといけない)

- データのノイズや単純じゃない
  - それでも日本の緊急地震速報は精度が優秀
  - The Limits of Earthquake Early Warning Accuracy and Best ...

- 2011年の東日本大震災
  - 本震以降、多くの地震が起きた。
  - 距離の近いところで同時に地震が起きる現象も見られた
  - もともと1つの地震を予測するモデルだったので、同時発生する構造は想定外
    - 一回やめたくらいブレる

- 同時発生の問題をベイズ推論で行う
  - モデルそのものはシンプル
  - 尤度のハズレ度合いで「2つの地震が必要になった」と判別し、修正して進める

## 材料設計(機械学習とベイズ)
- ポリマー分子の生成
  - 分子の編集をする際のベイズ評価(SMC/MCMC/HMCによる更新)
  - 高熱伝導率ポリマーの作成に成功
    - 既存のポリマーを少しずつ編集
    - 目標値(熱伝導率)に対する尤度から、それが改善する方向に編集する
  - 分子配列を文字列に変換する
    - 配列の「次」を予測する
    - 検索ワードのサジェストに近い発想。
    - Neural Network(データが少ないと厳しい)
    - 熱伝導性に近く、データが多い物性で学習し、転移学習。

## 階層ベイズモデルの応用
- 土壌
  - 建物を建てる時に土壌の検査が重要。
  - でも高コスト。
  - 土壌の関係性は結構相関があるかも……？
  - 局地的な情報は少ない。
  - 階層ベイズを使って、地域別の土壌の分布を制御する
    - Gibbs Sampplingでやる(縮小推定)
    - 2019年で最良のモデルを大きく改善。
- 分子動力学
  - 分子コンペで見た
  - 水分子の力場
    - いろんな物性があって、一気に予測したい
    - 「あっ、これ階層ベイズだね！」ってなる？
    - 不確定性の定量化をすることで、ネガティブな結果でも「無駄な失敗」じゃなくなる。